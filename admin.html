<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Senpai Anime</title>
    <script src="https://unpkg.com/@tailwindcss/browser@4"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <script>
        // Function to generate a unique ID
        function generateId() {
            return 'anime_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }
        
        // Function to load existing anime data
        function loadExistingAnime() {
            const animeList = document.getElementById('animeList');
            const animeData = JSON.parse(localStorage.getItem('animeData')) || [];
            
            if (animeData.length === 0) {
                animeList.innerHTML = `
                    <tr>
                        <td colspan="7" class="px-6 py-8 text-center text-gray-400">
                            <div class="flex flex-col items-center">
                                <i data-feather="inbox" class="w-12 h-12 mb-4 text-gray-600"></i>
                                <p class="text-lg">No anime uploaded yet</p>
                                <p class="text-sm text-gray-500 mb-4">Add your first anime using the form above</p>
                                <button onclick="document.getElementById('title').focus()" 
                                        class="px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg transition duration-300 text-white">
                                    <i data-feather="plus" class="w-4 h-4 mr-2"></i> Add Your First Anime
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
                return;
            }
            
            // Sort by date added (newest first)
            animeData.sort((a, b) => new Date(b.dateAdded) - new Date(a.dateAdded));
            
            animeList.innerHTML = '';
            animeData.forEach(anime => {
                animeList.innerHTML += `
                    <tr class="border-b border-gray-700 hover:bg-gray-800/50 transition duration-200">
                        <td class="px-6 py-4">
                            <div class="flex items-center space-x-3">
                                <img src="${anime.thumbnail || 'https://placehold.co/100x150/1f2937/FFFFFF?text=Anime'}" 
                                     alt="${anime.title}" 
                                     class="w-12 h-16 object-cover rounded">
                                <div>
                                    <div class="font-medium text-white">${anime.title}</div>
                                    <div class="text-sm text-gray-400 flex items-center gap-1">
                                        <span>${anime.genre || 'No genre'}</span>
                                        <span class="mx-1">â€¢</span>
                                        <span>${anime.language || 'Subtitled'}</span>
                                    </div>
                                </div>
                            </div>
                        </td>
                        <td class="px-6 py-4">
                            <span class="px-2 py-1 bg-red-900/50 text-red-300 rounded-md text-xs">
                                ${anime.currentEpisode || '1'}/${anime.totalEpisodes || anime.currentEpisode || '1'}
                            </span>
                        </td>
                        <td class="px-6 py-4 max-w-xs truncate">${anime.description || 'No description'}</td>
                        <td class="px-6 py-4">
                            <div class="flex items-center gap-2">
                                <i data-feather="eye" class="w-4 h-4 text-gray-500"></i>
                                <span>${anime.views || 0}</span>
                            </div>
                        </td>
                        <td class="px-6 py-4">${new Date(anime.dateAdded).toLocaleDateString()}</td>
                        <td class="px-6 py-4">
                            ${anime.videoUrl ? `
                                <span class="px-2 py-1 bg-green-900/50 text-green-300 rounded-md text-xs">
                                    <i data-feather="check" class="w-3 h-3 mr-1 inline"></i> Available
                                </span>
                            ` : `
                                <span class="px-2 py-1 bg-gray-700 text-gray-400 rounded-md text-xs">
                                    <i data-feather="x" class="w-3 h-3 mr-1 inline"></i> None
                                </span>
                            `}
                        </td>
                        <td class="px-6 py-4">
                            <div class="flex gap-2">
                                <button onclick="editAnime('${anime.id}')" 
                                        class="flex items-center justify-center w-8 h-8 bg-blue-600/50 text-white rounded hover:bg-blue-700 transition duration-300"
                                        title="Edit">
                                    <i data-feather="edit" class="w-4 h-4"></i>
                                </button>
                                <button onclick="deleteAnime('${anime.id}')" 
                                        class="flex items-center justify-center w-8 h-8 bg-red-600/50 text-white rounded hover:bg-red-700 transition duration-300"
                                        title="Delete">
                                    <i data-feather="trash" class="w-4 h-4"></i>
                                </button>
                                <a href="watch.html?id=${anime.id}&ep=1" 
                                   class="flex items-center justify-center w-8 h-8 bg-purple-600/50 text-white rounded hover:bg-purple-700 transition duration-300"
                                   title="Preview" target="_blank">
                                    <i data-feather="eye" class="w-4 h-4"></i>
                                </a>
                            </div>
                        </td>
                    </tr>
                `;
            });
            
            // Replace feather icons in new content
            feather.replace();
        }
        
        // Function to handle form submission
        function handleFormSubmit(event) {
            event.preventDefault();
            
            // Show loading state
            const submitBtn = document.getElementById('submitBtn');
            const originalBtnText = submitBtn.innerHTML;
            submitBtn.disabled = true;
            submitBtn.innerHTML = `<i data-feather="loader" class="w-5 h-5 animate-spin mr-2"></i> Processing...`;
            feather.replace();
            
            // Get values from form
            const title = document.getElementById('title').value.trim();
            const genre = document.getElementById('genre').value;
            const currentEpisode = document.getElementById('currentEpisode').value || "1";
            const totalEpisodes = document.getElementById('totalEpisodes').value || currentEpisode || '1';
            const thumbnail = document.getElementById('thumbnail').value;
            const language = document.getElementById('language').value;
            const description = document.getElementById('description').value;
            const videoUrl = document.getElementById('videoUrl').value;
            
            // Check if we're editing or adding new
            const editingId = document.getElementById('editingId').value;
            const episodeNumber = document.getElementById('episodeNumber').value || "1";
            
            // Get existing data
            let animeData = JSON.parse(localStorage.getItem('animeData')) || [];
            
            // Handle episode addition to existing anime
            if (document.getElementById('addingEpisode').value === 'true') {
                const animeId = document.getElementById('animeIdForEpisode').value;
                if (!animeId) {
                    alert('No anime selected for adding episode');
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = originalBtnText;
                    feather.replace();
                    return;
                }
                
                const anime = animeData.find(a => a.id === animeId);
                if (!anime) {
                    alert('Selected anime not found');
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = originalBtnText;
                    feather.replace();
                    return;
                }
                
                // Initialize episodes array if it doesn't exist
                if (!anime.episodes) {
                    anime.episodes = [];
                }
                
                // Check if this episode number already exists
                const episodeExists = anime.episodes.some(ep => ep.episode == episodeNumber);
                if (episodeExists) {
                    const confirmReplace = confirm(`Episode ${episodeNumber} already exists. Do you want to replace it?`);
                    if (confirmReplace) {
                        // Remove existing episode
                        anime.episodes = anime.episodes.filter(ep => ep.episode != episodeNumber);
                    } else {
                        submitBtn.disabled = false;
                        submitBtn.innerHTML = originalBtnText;
                        feather.replace();
                        return;
                    }
                }
                
                // Add the new episode
                anime.episodes.push({
                    episode: parseInt(episodeNumber),
                    videoUrl: videoUrl,
                    dateAdded: new Date().toISOString()
                });
                
                // Update episode count information
                const epNumbers = anime.episodes.map(ep => parseInt(ep.episode));
                anime.currentEpisode = Math.max(...epNumbers);
                anime.totalEpisodes = Math.max(...epNumbers, parseInt(anime.totalEpisodes || 0));
                anime.lastUpdated = new Date().toISOString();
                
                // Save to localStorage
                localStorage.setItem('animeData', JSON.stringify(animeData));
                
                // Reset form and update list
                document.getElementById('animeForm').reset();
                document.getElementById('editingId').value = '';
                document.getElementById('addingEpisode').value = 'false';
                document.getElementById('animeIdForEpisode').value = '';
                document.getElementById('episodeFormSection').classList.add('hidden');
                document.getElementById('animeFormSection').classList.remove('hidden');
                document.getElementById('formTitle').textContent = 'Add New Anime';
                document.getElementById('submitBtn').innerHTML = '<i data-feather="plus-circle" class="w-5 h-5 mr-2"></i> Add Anime';
                feather.replace();
                
                // Update the table
                loadExistingAnime();
                
                // Show success notification
                showNotification(`Episode ${episodeNumber} added to "${anime.title}" successfully!`);
                
                // Restore button state
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalBtnText;
                feather.replace();
                
                return;
            }
            
            // Check for duplicate anime title when adding new
            if (!editingId) {
                const isDuplicate = animeData.some(anime => anime.title.toLowerCase() === title.toLowerCase());
                
                if (isDuplicate) {
                    // Find the existing anime with the same title
                    const existingAnime = animeData.find(anime => anime.title.toLowerCase() === title.toLowerCase());
                    
                    // Ask if user wants to add a new episode instead
                    const shouldAddEpisode = confirm(`An anime with the title "${title}" already exists. Would you like to add a new episode to it instead?`);
                    
                    if (shouldAddEpisode) {
                        // Switch to episode form
                        document.getElementById('animeFormSection').classList.add('hidden');
                        document.getElementById('episodeFormSection').classList.remove('hidden');
                        document.getElementById('animeIdForEpisode').value = existingAnime.id;
                        document.getElementById('animeNameForEpisode').textContent = existingAnime.title;
                        document.getElementById('addingEpisode').value = 'true';
                        document.getElementById('episodeTitle').value = title;
                        document.getElementById('formTitle').textContent = 'Add New Episode';
                        document.getElementById('submitBtn').innerHTML = '<i data-feather="plus-circle" class="w-5 h-5 mr-2"></i> Add Episode';
                        feather.replace();
                        
                        // Restore button state
                        submitBtn.disabled = false;
                        submitBtn.innerHTML = originalBtnText;
                        feather.replace();
                        
                        return;
                    }
                    
                    // If user doesn't want to add episode, show error and return
                    alert(`An anime with the title "${title}" already exists. Please use a different title.`);
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = originalBtnText;
                    feather.replace();
                    return;
                }
            }
            
            // Process normal form submission
            if (editingId) {
                // Update existing anime
                const index = animeData.findIndex(anime => anime.id === editingId);
                if (index !== -1) {
                    // Create episodes array if not exists
                    if (!animeData[index].episodes) {
                        animeData[index].episodes = [
                            {
                                episode: parseInt(currentEpisode) || 1,
                                videoUrl: videoUrl,
                                dateAdded: animeData[index].dateAdded
                            }
                        ];
                    }
                    
                    animeData[index] = {
                        ...animeData[index],
                        title,
                        genre,
                        currentEpisode,
                        totalEpisodes,
                        thumbnail,
                        language,
                        description,
                        videoUrl,
                        lastUpdated: new Date().toISOString()
                    };
                }
            } else {
                // Add new anime
                const newAnime = {
                    id: generateId(),
                    title,
                    genre,
                    currentEpisode,
                    totalEpisodes,
                    thumbnail,
                    language,
                    description,
                    videoUrl,
                    views: 0,
                    dateAdded: new Date().toISOString(),
                    lastUpdated: new Date().toISOString(),
                    episodes: [
                        {
                            episode: parseInt(currentEpisode) || 1,
                            videoUrl: videoUrl,
                            dateAdded: new Date().toISOString()
                        }
                    ]
                };
                
                animeData.push(newAnime);
            }
            
            // Save to localStorage
            localStorage.setItem('animeData', JSON.stringify(animeData));
            
            // Reset form and update list
            document.getElementById('animeForm').reset();
            document.getElementById('editingId').value = '';
            document.getElementById('formTitle').textContent = 'Add New Anime';
            document.getElementById('submitBtn').innerHTML = '<i data-feather="plus-circle" class="w-5 h-5 mr-2"></i> Add Anime';
            feather.replace();
            document.getElementById('videoPreview').innerHTML = '';
            document.getElementById('thumbnailPreview').style.backgroundImage = '';
            document.getElementById('thumbnailPreview').classList.add('hidden');
            
            // Update the table
            loadExistingAnime();
            
            // Show success notification
            showNotification(editingId ? 'Anime updated successfully!' : 'Anime added successfully!');
            
            // Restore button state
            submitBtn.disabled = false;
            submitBtn.innerHTML = originalBtnText;
            feather.replace();
        }
        
        // Function to edit anime
        function editAnime(id) {
            const animeData = JSON.parse(localStorage.getItem('animeData')) || [];
            const anime = animeData.find(a => a.id === id);
            
            if (anime) {
                // Fill form with anime data
                document.getElementById('title').value = anime.title;
                document.getElementById('genre').value = anime.genre || '';
                document.getElementById('currentEpisode').value = anime.currentEpisode || '';
                document.getElementById('totalEpisodes').value = anime.totalEpisodes || '';
                document.getElementById('thumbnail').value = anime.thumbnail || '';
                document.getElementById('language').value = anime.language || '';
                document.getElementById('description').value = anime.description || '';
                document.getElementById('videoUrl').value = anime.videoUrl || '';
                document.getElementById('editingId').value = anime.id;
                
                // Show thumbnail preview if exists
                if (anime.thumbnail) {
                    document.getElementById('thumbnailPreview').style.backgroundImage = `url(${anime.thumbnail})`;
                    document.getElementById('thumbnailPreview').classList.remove('hidden');
                }
                
                // Show video preview if exists
                if (anime.videoUrl) {
                    document.getElementById('videoPreview').innerHTML = `
                        <div class="relative">
                            <video src="${anime.videoUrl}" class="w-full h-auto rounded-lg" controls></video>
                            <div class="absolute top-2 right-2 bg-black bg-opacity-70 text-white text-xs px-2 py-1 rounded">
                                Current video
                            </div>
                        </div>
                    `;
                }
                
                // Update form title and button
                document.getElementById('formTitle').textContent = 'Edit Anime';
                document.getElementById('submitBtn').innerHTML = '<i data-feather="save" class="w-5 h-5 mr-2"></i> Update Anime';
                feather.replace();
                
                // Make anime form visible (in case we're in episode mode)
                document.getElementById('animeFormSection').classList.remove('hidden');
                document.getElementById('episodeFormSection').classList.add('hidden');
                document.getElementById('addingEpisode').value = 'false';
                
                // Scroll to form
                document.getElementById('animeFormCard').scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        // Function to add episode to an anime
        function addEpisode(id) {
            const animeData = JSON.parse(localStorage.getItem('animeData')) || [];
            const anime = animeData.find(a => a.id === id);
            
            if (anime) {
                // Switch to episode form
                document.getElementById('animeFormSection').classList.add('hidden');
                document.getElementById('episodeFormSection').classList.remove('hidden');
                document.getElementById('animeIdForEpisode').value = anime.id;
                document.getElementById('animeNameForEpisode').textContent = anime.title;
                document.getElementById('addingEpisode').value = 'true';
                
                // Clear episode form
                document.getElementById('episodeNumber').value = '';
                document.getElementById('episodeTitle').value = '';
                document.getElementById('videoUrl').value = '';
                document.getElementById('videoPreview').innerHTML = '';
                
                // Update form title and button
                document.getElementById('formTitle').textContent = 'Add New Episode';
                document.getElementById('submitBtn').innerHTML = '<i data-feather="plus-circle" class="w-5 h-5 mr-2"></i> Add Episode';
                feather.replace();
                
                // Scroll to form
                document.getElementById('animeFormCard').scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }
        
        // Function to delete anime
        function deleteAnime(id) {
            if (confirm('Are you sure you want to delete this anime? This action cannot be undone.')) {
                let animeData = JSON.parse(localStorage.getItem('animeData')) || [];
                animeData = animeData.filter(anime => anime.id !== id);
                localStorage.setItem('animeData', JSON.stringify(animeData));
                
                // Update the table
                loadExistingAnime();
                
                // Show notification
                showNotification('Anime deleted successfully!');
            }
        }
        
        // Function to show notification
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.className = `fixed top-6 right-6 px-6 py-3 rounded-lg shadow-lg opacity-0 transition-opacity duration-300 z-50 ${
                type === 'success' ? 'bg-green-600 text-white' : 'bg-red-600 text-white'
            }`;
            notification.innerHTML = `
                <div class="flex items-center gap-3">
                    <i data-feather="${type === 'success' ? 'check-circle' : 'alert-circle'}" class="w-5 h-5"></i>
                    <span>${message}</span>
                </div>
            `;
            feather.replace();
            notification.classList.remove('opacity-0');
            notification.classList.add('opacity-100');
            
            // Hide after 3 seconds
            setTimeout(() => {
                notification.classList.remove('opacity-100');
                notification.classList.add('opacity-0');
            }, 3000);
        }
        
        // Helper function to handle thumbnail file uploads
        function handleThumbnailUpload(event) {
            const file = event.target.files[0];
            
            if (!file) return;
            
            // Check file type
            if (!file.type.startsWith('image/')) {
                showNotification('Please select an image file', 'error');
                event.target.value = '';
                return;
            }
            
            // Show thumbnail preview
            const reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById('thumbnailPreview').style.backgroundImage = `url(${e.target.result})`;
                document.getElementById('thumbnailPreview').classList.remove('hidden');
                document.getElementById('thumbnail').value = e.target.result;
            };
            reader.readAsDataURL(file);
            
            // Update file name display
            document.getElementById('imageFileName').textContent = file.name;
        }
        
        // Helper function to handle video file uploads
        function handleVideoUpload(event) {
            const file = event.target.files[0];
            
            if (!file) return;
            
            // Check file type
            if (!file.type.startsWith('video/')) {
                showNotification('Please select a video file', 'error');
                event.target.value = '';
                return;
            }
            
            // Extract episode number from filename
            const fileName = file.name;
            const episodeMatch = fileName.match(/[Ee]pisode\s*(\d+)|[Ee]p\s*(\d+)|[Ee]\s*(\d+)|S\d+E(\d+)/);
            
            if (episodeMatch) {
                // Find the first capture group that's not undefined and is a number
                const extractedEp = episodeMatch.slice(1).find(match => match && !isNaN(match));
                if (extractedEp) {
                    if (document.getElementById('addingEpisode').value === 'true') {
                        document.getElementById('episodeNumber').value = extractedEp;
                    } else {
                        document.getElementById('currentEpisode').value = extractedEp;
                    }
                    showNotification(`Episode ${extractedEp} detected from filename!`);
                }
            }
            
            // Video preview
            const reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById('videoPreview').innerHTML = `
                    <div class="relative rounded-lg overflow-hidden">
                        <video src="${e.target.result}" class="w-full h-auto" controls></video>
                        <div class="absolute top-2 right-2 bg-black bg-opacity-70 text-white text-xs px-2 py-1 rounded">
                            File: ${file.name}
                        </div>
                    </div>
                `;
                document.getElementById('videoUrl').value = e.target.result;
            };
            reader.readAsDataURL(file);
        }
        
        // Function to switch back to anime form
        function switchToAnimeForm() {
            document.getElementById('episodeFormSection').classList.add('hidden');
            document.getElementById('animeFormSection').classList.remove('hidden');
            document.getElementById('addingEpisode').value = 'false';
            document.getElementById('animeIdForEpisode').value = '';
            document.getElementById('formTitle').textContent = 'Add New Anime';
            document.getElementById('submitBtn').innerHTML = '<i data-feather="plus-circle" class="w-5 h-5 mr-2"></i> Add Anime';
            feather.replace();
            document.getElementById('animeForm').reset();
            document.getElementById('videoPreview').innerHTML = '';
            document.getElementById('thumbnailPreview').style.backgroundImage = '';
            document.getElementById('thumbnailPreview').classList.add('hidden');
        }
        
        // Initialize on page load
        window.addEventListener('DOMContentLoaded', () => {
            // Replace all feather icons
            feather.replace();
            
            // Load existing anime data
            loadExistingAnime();
            
            // Set up form submission handler
            document.getElementById('animeForm').addEventListener('submit', handleFormSubmit);
            
            // Set up file upload handlers
            document.getElementById('thumbnailFile').addEventListener('change', handleThumbnailUpload);
            document.getElementById('videoFile').addEventListener('change', handleVideoUpload);
        });
    </script>
    <style>
        body {
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(31, 41, 55, 0.5);
        }
        
        ::-webkit-scrollbar-thumb {
            background: rgba(239, 68, 68, 0.6);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(239, 68, 68, 0.8);
        }
        
        /* Red gradient for heading */
        .red-gradient {
            background: linear-gradient(90deg, #ff4b4b 0%, #ff0000 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-fill-color: transparent;
        }
        
        /* Glassmorphism effect */
        .glassmorphism {
            background: rgba(17, 24, 39, 0.6);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 77, 77, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen">
    <!-- Notification -->
    <div id="notification" class="opacity-0 transition-opacity duration-300 z-50"></div>
    
    <!-- Header -->
    <header class="bg-gray-800/80 backdrop-blur-md shadow-lg sticky top-0 z-40">
        <div class="container mx-auto px-4 py-3">
            <div class="flex items-center justify-between">
                <div class="flex items-center">
                    <div class="w-10 h-10 rounded-full bg-gradient-to-r from-red-600 to-red-500 flex items-center justify-center text-xl font-bold">S</div>
                    <div class="ml-3">
                        <h1 class="text-xl font-bold red-gradient">Senpai Anime</h1>
                        <p class="text-xs text-red-400">Admin Panel</p>
                    </div>
                </div>
                
                <div class="flex items-center space-x-3">
                    <a href="index.html" class="px-4 py-2 bg-gray-700/80 hover:bg-gray-600 rounded-lg transition duration-300 text-sm flex items-center gap-2">
                        <i data-feather="home"></i>
                        <span class="hidden sm:inline">Back to Website</span>
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Admin Dashboard -->
        <div id="animeFormCard" class="bg-gray-800/60 backdrop-blur-sm rounded-xl p-6 shadow-lg mb-8 border border-transparent transition-colors duration-500">
            <h2 class="text-2xl font-bold text-red-400 mb-6 flex items-center gap-2" id="formTitle">
                <i data-feather="plus-circle"></i> Add New Anime
            </h2>
            
            <form id="animeForm" class="space-y-6">
                <input type="hidden" id="editingId" value="">
                <input type="hidden" id="addingEpisode" value="false">
                <input type="hidden" id="animeIdForEpisode" value="">
                
                <!-- Anime Form Section -->
                <div id="animeFormSection">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="title" class="block text-sm font-medium mb-2">Anime Title</label>
                            <input type="text" id="title" required
                                   class="w-full px-4 py-2 bg-gray-700/70 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 border border-gray-600">
                        </div>
                        
                        <div>
                            <label for="genre" class="block text-sm font-medium mb-2">Genre</label>
                            <select id="genre" required
                                    class="w-full px-4 py-2 bg-gray-700/70 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 border border-gray-600">
                                <option value="">Select Genre</option>
                                <option value="Action">Action</option>
                                <option value="Adventure">Adventure</option>
                                <option value="Comedy">Comedy</option>
                                <option value="Drama">Drama</option>
                                <option value="Fantasy">Fantasy</option>
                                <option value="Horror">Horror</option>
                                <option value="Isekai">Isekai</option>
                                <option value="Mystery">Mystery</option>
                                <option value="Romance">Romance</option>
                                <option value="Sci-Fi">Sci-Fi</option>
                                <option value="Slice of Life">Slice of Life</option>
                                <option value="Sports">Sports</option>
                                <option value="Supernatural">Supernatural</option>
                            </select>
                        </div>
                        
                        <div>
                            <label for="currentEpisode" class="block text-sm font-medium mb-2">Current Episode</label>
                            <div class="flex gap-3">
                                <input type="number" id="currentEpisode" min="1"
                                      class="w-full px-4 py-2 bg-gray-700/70 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 border border-gray-600"
                                      placeholder="Auto-detected from video">
                                <span class="px-3 py-2 bg-gray-700/70 rounded-lg border border-gray-600">of</span>
                                <input type="number" id="totalEpisodes" min="1"
                                      class="w-full px-4 py-2 bg-gray-700/70 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 border border-gray-600" 
                                      placeholder="Total episodes">
                            </div>
                        </div>
                        
                        <div>
                            <label for="language" class="block text-sm font-medium mb-2">Language</label>
                            <select id="language" required
                                    class="w-full px-4 py-2 bg-gray-700/70 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 border border-gray-600">
                                <option value="">Select Language</option>
                                <option value="Subtitled">Subtitled</option>
                                <option value="Dubbed">Dubbed</option>
                                <option value="Raw">Raw (No Subtitles)</option>
                            </select>
                        </div>
                        
                        <div>
                            <label for="thumbnail" class="block text-sm font-medium mb-2">Thumbnail URL</label>
                            <div class="relative">
                                <input type="text" id="thumbnail" placeholder="https://example.com/image.jpg"
                                      class="w-full px-4 py-2 pl-10 bg-gray-700/70 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 border border-gray-600">
                                <i data-feather="link" class="absolute left-3 top-3 text-gray-400 w-4 h-4"></i>
                            </div>
                            <div class="mt-2 text-sm text-gray-400 flex items-center gap-2">
                                <i data-feather="info" class="w-4 h-4"></i>
                                <span id="imageFileName">No file selected</span>
                            </div>
                            <div id="thumbnailPreview" class="mt-3 h-40 w-28 bg-cover bg-center rounded-lg hidden"></div>
                        </div>
                        
                        <div>
                            <label for="videoUrl" class="block text-sm font-medium mb-2">Video URL</label>
                            <div class="relative">
                                <input type="text" id="videoUrl" placeholder="https://example.com/video.mp4"
                                      class="w-full px-4 py-2 pl-10 bg-gray-700/70 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 border border-gray-600">
                                <i data-feather="link" class="absolute left-3 top-3 text-gray-400 w-4 h-4"></i>
                            </div>
                            <p class="mt-2 text-xs text-gray-500">
                                Enter a URL or upload a video file below
                            </p>
                        </div>
                        
                        <div class="md:col-span-2">
                            <label for="description" class="block text-sm font-medium mb-2">Description</label>
                            <textarea id="description" rows="4"
                                     class="w-full px-4 py-2 bg-gray-700/70 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 border border-gray-600"></textarea>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium mb-2">Upload Thumbnail</label>
                            <label class="flex items-center px-4 py-2 bg-gray-700 rounded-lg cursor-pointer hover:bg-gray-600 transition duration-300">
                                <i data-feather="image" class="w-5 h-5 mr-2"></i>
                                <span>Choose Image</span>
                                <input type="file" id="thumbnailFile" accept="image/*" class="hidden">
                            </label>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium mb-2">Upload Video</label>
                            <label class="flex items-center px-4 py-2 bg-gray-700 rounded-lg cursor-pointer hover:bg-gray-600 transition duration-300">
                                <i data-feather="video" class="w-5 h-5 mr-2"></i>
                                <span>Choose Video</span>
                                <input type="file" id="videoFile" accept="video/*" class="hidden">
                            </label>
                            <p class="mt-2 text-xs text-gray-500">
                                Episode number will be automatically detected from filename (if present)
                            </p>
                        </div>
                    </div>
                </div>
                
                <!-- Episode Form Section -->
                <div id="episodeFormSection" class="hidden">
                    <div class="mb-6 p-4 bg-gray-700/50 rounded-lg">
                        <h3 class="text-xl font-semibold mb-2">
                            Adding Episode to <span id="animeNameForEpisode" class="text-red-400">Anime</span>
                        </h3>
                        <p class="text-sm text-gray-400">
                            You are adding a new episode to an existing anime. Fill in the details below.
                        </p>
                        <button type="button" onclick="switchToAnimeForm()" class="mt-2 text-red-400 hover:text-red-300">
                            <i data-feather="arrow-left" class="w-4 h-4 inline mr-1"></i> Back to adding new anime
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="episodeNumber" class="block text-sm font-medium mb-2">Episode Number</label>
                            <input type="number" id="episodeNumber" min="1" required
                                   class="w-full px-4 py-2 bg-gray-700/70 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 border border-gray-600"
                                   placeholder="Auto-detected from video">
                        </div>
                        
                        <div>
                            <label for="episodeTitle" class="block text-sm font-medium mb-2">Episode Title (Optional)</label>
                            <input type="text" id="episodeTitle"
                                   class="w-full px-4 py-2 bg-gray-700/70 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 border border-gray-600"
                                   placeholder="Episode title">
                        </div>
                        
                        <div class="md:col-span-2">
                            <label for="videoUrl" class="block text-sm font-medium mb-2">Video URL</label>
                            <div class="relative">
                                <input type="text" id="videoUrl" placeholder="https://example.com/video.mp4" required
                                      class="w-full px-4 py-2 pl-10 bg-gray-700/70 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 border border-gray-600">
                                <i data-feather="link" class="absolute left-3 top-3 text-gray-400 w-4 h-4"></i>
                            </div>
                            <p class="mt-2 text-xs text-gray-500">
                                Enter a URL or upload a video file below
                            </p>
                        </div>
                        
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium mb-2">Upload Video</label>
                            <label class="flex items-center px-4 py-2 bg-gray-700 rounded-lg cursor-pointer hover:bg-gray-600 transition duration-300">
                                <i data-feather="video" class="w-5 h-5 mr-2"></i>
                                <span>Choose Video</span>
                                <input type="file" id="videoFile" accept="video/*" class="hidden">
                            </label>
                        </div>
                    </div>
                </div>
                
                <div id="videoPreview" class="mt-3"></div>
                
                <div class="flex justify-end">
                    <button type="submit" id="submitBtn"
                            class="px-6 py-2 bg-red-600 hover:bg-red-700 rounded-lg transition duration-300 flex items-center gap-2">
                        <i data-feather="plus-circle" class="w-5 h-5"></i> Add Anime
                    </button>
                </div>
            </form>
        </div>
        
        <!-- Anime List -->
        <div class="bg-gray-800/60 backdrop-blur-sm rounded-xl shadow-lg overflow-hidden">
            <div class="p-6 border-b border-gray-700 flex justify-between items-center">
                <h2 class="text-2xl font-bold text-red-400 flex items-center gap-2">
                    <i data-feather="film"></i> Anime Collection
                </h2>
                
                <div class="relative">
                    <input type="text" id="tableSearch" placeholder="Search anime..." 
                           class="px-4 py-2 pl-10 bg-gray-700/70 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 border border-gray-600 text-sm">
                    <i data-feather="search" class="absolute left-3 top-2.5 text-gray-400 w-4 h-4"></i>
                </div>
            </div>
            
            <div class="overflow-x-auto">
                <table class="w-full">
                    <thead class="bg-gray-700/70">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider">Anime</th>
                            <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider">Episode</th>
                            <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider">Description</th>
                            <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider">Views</th>
                            <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider">Date Added</th>
                            <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider">Video</th>
                            <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="animeList">
                        <!-- Anime list will be populated via JavaScript -->
                        <tr>
                            <td colspan="7" class="px-6 py-8 text-center text-gray-400">
                                <div class="flex justify-center mb-4">
                                    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-red-500"></div>
                                </div>
                                <p>Loading anime collection...</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800/80 backdrop-blur-sm py-6 mt-12">
        <div class="container mx-auto px-4 text-center text-gray-500 text-sm">
            <p>&copy; 2025 Senpai Anime Admin. All rights reserved.</p>
            <p class="mt-1">A personal anime collection management system.</p>
        </div>
    </footer>
</body>
</html>
